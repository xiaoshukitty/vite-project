import{i as e,O as a,G as t,k as l,d as n,n as s,l as o,C as i,u as r,y as c,q as u,_ as d,E as v,m as f,w as m,o as p,P as g,x as y,K as b}from"./el-icon-gyngf5Lo.js";import{x as w,aC as k,aD as h,aE as x,r as z,aF as C,s as _,f as I,w as S,C as O,h as N,o as E,K as T,P as L,L as R,u as A,H as B,S as Y,Q as $,J as X,F,a4 as M,G as P,ar as j,as as D,c as H,aG as G,aH as W,M as K,aI as q,aJ as J,E as V,D as Q,ad as U,I as Z,U as ee,a0 as ae,y as te,R as le,O as ne,v as se,a5 as oe,an as ie,ao as re,_ as ce}from"./index-inZ3uqEB.js";function ue(e,l,n){var s=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(n)&&(s="leading"in n?!!n.leading:s,o="trailing"in n?!!n.trailing:o),t(e,l,{leading:s,maxWait:l,trailing:o})}const de=l({urlList:{type:n(Array),default:()=>s([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),ve={close:()=>!0,switch:e=>o(e),rotate:e=>o(e)},fe=["src"],me=w({name:"ElImageViewer"});const pe=m(d(w({...me,props:de,emits:ve,setup(e,{expose:a,emit:t}){const l=e,n={CONTAIN:{name:"contain",icon:k(h)},ORIGINAL:{name:"original",icon:k(x)}},{t:s}=i(),d=r("image-viewer"),{nextZIndex:m}=c(),p=z(),g=z([]),y=C(),b=z(!0),w=z(l.initialIndex),te=_(n.CONTAIN),le=z({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ne=I((()=>{const{urlList:e}=l;return e.length<=1})),se=I((()=>0===w.value)),oe=I((()=>w.value===l.urlList.length-1)),ie=I((()=>l.urlList[w.value])),re=I((()=>[d.e("btn"),d.e("prev"),d.is("disabled",!l.infinite&&se.value)])),ce=I((()=>[d.e("btn"),d.e("next"),d.is("disabled",!l.infinite&&oe.value)])),de=I((()=>{const{scale:e,deg:a,offsetX:t,offsetY:l,enableTransition:s}=le.value;let o=t/e,i=l/e;switch(a%360){case 90:case-270:[o,i]=[i,-o];break;case 180:case-180:[o,i]=[-o,-i];break;case 270:case-90:[o,i]=[-i,o]}const r={transform:`scale(${e}) rotate(${a}deg) translate(${o}px, ${i}px)`,transition:s?"transform .3s":""};return te.value.name===n.CONTAIN.name&&(r.maxWidth=r.maxHeight="100%"),r})),ve=I((()=>o(l.zIndex)?l.zIndex:m()));function me(){y.stop(),t("close")}function pe(){b.value=!1}function ge(e){b.value=!1,e.target.alt=s("el.image.error")}function ye(e){if(b.value||0!==e.button||!p.value)return;le.value.enableTransition=!1;const{offsetX:a,offsetY:t}=le.value,l=e.pageX,n=e.pageY,s=ue((e=>{le.value={...le.value,offsetX:a+e.pageX-l,offsetY:t+e.pageY-n}})),o=f(document,"mousemove",s);f(document,"mouseup",(()=>{o()})),e.preventDefault()}function be(){le.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function we(){if(b.value)return;const e=(a=n,Object.keys(a));var a;const t=Object.values(n),l=te.value.name,s=(t.findIndex((e=>e.name===l))+1)%e.length;te.value=n[e[s]],be()}function ke(e){const a=l.urlList.length;w.value=(e+a)%a}function he(){se.value&&!l.infinite||ke(w.value-1)}function xe(){oe.value&&!l.infinite||ke(w.value+1)}function ze(e,a={}){if(b.value)return;const{minScale:n,maxScale:s}=l,{zoomRate:o,rotateDeg:i,enableTransition:r}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":le.value.scale>n&&(le.value.scale=Number.parseFloat((le.value.scale/o).toFixed(3)));break;case"zoomIn":le.value.scale<s&&(le.value.scale=Number.parseFloat((le.value.scale*o).toFixed(3)));break;case"clockwise":le.value.deg+=i,t("rotate",le.value.deg);break;case"anticlockwise":le.value.deg-=i,t("rotate",le.value.deg)}le.value.enableTransition=r}return S(ie,(()=>{O((()=>{const e=g.value[0];(null==e?void 0:e.complete)||(b.value=!0)}))})),S(w,(e=>{be(),t("switch",e)})),N((()=>{var e,a;!function(){const e=ue((e=>{switch(e.code){case v.esc:l.closeOnPressEscape&&me();break;case v.space:we();break;case v.left:he();break;case v.up:ze("zoomIn");break;case v.right:xe();break;case v.down:ze("zoomOut")}})),a=ue((e=>{ze((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})}));y.run((()=>{f(document,"keydown",e),f(document,"wheel",a)}))}(),null==(a=null==(e=p.value)?void 0:e.focus)||a.call(e)})),a({setActiveItem:ke}),(e,a)=>(E(),T(ae,{to:"body",disabled:!e.teleported},[L(ee,{name:"viewer-fade",appear:""},{default:R((()=>[X("div",{ref_key:"wrapper",ref:p,tabindex:-1,class:B(A(d).e("wrapper")),style:Y({zIndex:A(ve)})},[X("div",{class:B(A(d).e("mask")),onClick:a[0]||(a[0]=$((a=>e.hideOnClickModal&&me()),["self"]))},null,2),F(" CLOSE "),X("span",{class:B([A(d).e("btn"),A(d).e("close")]),onClick:me},[L(A(u),null,{default:R((()=>[L(A(M))])),_:1})],2),F(" ARROW "),A(ne)?F("v-if",!0):(E(),H(P,{key:0},[X("span",{class:B(A(re)),onClick:he},[L(A(u),null,{default:R((()=>[L(A(j))])),_:1})],2),X("span",{class:B(A(ce)),onClick:xe},[L(A(u),null,{default:R((()=>[L(A(D))])),_:1})],2)],64)),F(" ACTIONS "),X("div",{class:B([A(d).e("btn"),A(d).e("actions")])},[X("div",{class:B(A(d).e("actions__inner"))},[L(A(u),{onClick:a[1]||(a[1]=e=>ze("zoomOut"))},{default:R((()=>[L(A(G))])),_:1}),L(A(u),{onClick:a[2]||(a[2]=e=>ze("zoomIn"))},{default:R((()=>[L(A(W))])),_:1}),X("i",{class:B(A(d).e("actions__divider"))},null,2),L(A(u),{onClick:we},{default:R((()=>[(E(),T(K(A(te).icon)))])),_:1}),X("i",{class:B(A(d).e("actions__divider"))},null,2),L(A(u),{onClick:a[3]||(a[3]=e=>ze("anticlockwise"))},{default:R((()=>[L(A(q))])),_:1}),L(A(u),{onClick:a[4]||(a[4]=e=>ze("clockwise"))},{default:R((()=>[L(A(J))])),_:1})],2)],2),F(" CANVAS "),X("div",{class:B(A(d).e("canvas"))},[(E(!0),H(P,null,U(e.urlList,((e,a)=>Q((E(),H("img",{ref_for:!0,ref:e=>g.value[a]=e,key:e,src:e,style:Y(A(de)),class:B(A(d).e("img")),onLoad:pe,onError:ge,onMousedown:ye},null,46,fe)),[[V,a===w.value]]))),128))],2),Z(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}}),[["__file","image-viewer.vue"]])),ge=l({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:n([String,Object])},previewSrcList:{type:n(Array),default:()=>s([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),ye={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>o(e),close:()=>!0,show:()=>!0},be=["src","loading"],we={key:0},ke=w({name:"ElImage",inheritAttrs:!1});const he=m(d(w({...ke,props:ge,emits:ye,setup(a,{emit:t}){const l=a;let n="";const{t:s}=i(),o=r("image"),c=te(),u=p(),d=z(),v=z(!1),m=z(!0),w=z(!1),k=z(),h=z(),x=e&&"loading"in HTMLImageElement.prototype;let C,_;const L=I((()=>[o.e("inner"),j.value&&o.e("preview"),m.value&&o.is("loading")])),$=I((()=>c.style)),M=I((()=>{const{fit:a}=l;return e&&a?{objectFit:a}:{}})),j=I((()=>{const{previewSrcList:e}=l;return Array.isArray(e)&&e.length>0})),D=I((()=>{const{previewSrcList:e,initialIndex:a}=l;let t=a;return a>e.length-1&&(t=0),t})),G=I((()=>"eager"!==l.loading&&(!x&&"lazy"===l.loading||l.lazy))),W=()=>{e&&(m.value=!0,v.value=!1,d.value=l.src)};function K(e){m.value=!1,v.value=!1,t("load",e)}function q(e){m.value=!1,v.value=!0,t("error",e)}function J(){((a,t)=>{if(!e||!a||!t)return!1;const l=a.getBoundingClientRect();let n;return n=t instanceof Element?t.getBoundingClientRect():{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},l.top<n.bottom&&l.bottom>n.top&&l.right>n.left&&l.left<n.right})(k.value,h.value)&&(W(),U())}const V=g(J,200,!0);async function Q(){var a;if(!e)return;await O();const{scrollContainer:t}=l;y(t)?h.value=t:se(t)&&""!==t?h.value=null!=(a=document.querySelector(t))?a:void 0:k.value&&(h.value=b(k.value)),h.value&&(C=f(h,"scroll",V),setTimeout((()=>J()),100))}function U(){e&&h.value&&V&&(null==C||C(),h.value=void 0)}function ee(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function ae(){j.value&&(_=f("wheel",ee,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",w.value=!0,t("show"))}function oe(){null==_||_(),document.body.style.overflow=n,w.value=!1,t("close")}function ie(e){t("switch",e)}return S((()=>l.src),(()=>{G.value?(m.value=!0,v.value=!1,U(),Q()):W()})),N((()=>{G.value?Q():W()})),(e,a)=>(E(),H("div",{ref_key:"container",ref:k,class:B([A(o).b(),e.$attrs.class]),style:Y(A($))},[v.value?Z(e.$slots,"error",{key:0},(()=>[X("div",{class:B(A(o).e("error"))},le(A(s)("el.image.error")),3)])):(E(),H(P,{key:1},[void 0!==d.value?(E(),H("img",ne({key:0},A(u),{src:d.value,loading:e.loading,style:A(M),class:A(L),onClick:ae,onLoad:K,onError:q}),null,16,be)):F("v-if",!0),m.value?(E(),H("div",{key:1,class:B(A(o).e("wrapper"))},[Z(e.$slots,"placeholder",{},(()=>[X("div",{class:B(A(o).e("placeholder"))},null,2)]))],2)):F("v-if",!0)],64)),A(j)?(E(),H(P,{key:2},[w.value?(E(),T(A(pe),{key:0,"z-index":e.zIndex,"initial-index":A(D),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:oe,onSwitch:ie},{default:R((()=>[e.$slots.viewer?(E(),H("div",we,[Z(e.$slots,"viewer")])):F("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):F("v-if",!0)],64)):F("v-if",!0)],6))}}),[["__file","image.vue"]])),xe=(e=>(ie("data-v-c0c3d04f"),e=e(),re(),e))((()=>X("div",{class:"mask"},null,-1))),ze=ce(w({__name:"index",props:{imgSrc:{type:String,default:""}},setup(e){const a=["fill","contain","cover","none","scale-down"],t=()=>{},l=()=>{};return(n,s)=>{const o=he,i=oe("CaretRight"),r=u;return E(),H("div",{class:"playlist",onClick:l},[L(o,{class:"el_image",src:e.imgSrc,fit:a},null,8,["src"]),xe,L(r,{class:"icon",size:40,color:"#fff",onClick:$(t,["stop"])},{default:R((()=>[L(i)])),_:1})])}}}),[["__scopeId","data-v-c0c3d04f"]]);export{ze as P,ue as t};
