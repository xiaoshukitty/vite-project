import{i as e,d as a,e as t,m as l,c as n,u as s,E as o,_ as i,p as r,b as c,w as u,B as d,F as f}from"./el-icon-exrMpsb-.js";import{f as v,aC as m,aD as p,aE as g,r as y,aF as b,s as w,j as k,w as x,n as h,l as z,o as _,B as C,H as I,C as S,y as O,x as N,K as E,I as T,A,q as L,O as R,F as B,ak as Y,al as $,c as j,aG as F,aH as X,D,aI as M,aJ as P,p as H,m as W,a2 as q,z as G,T as J,Q as K,u as V,J as Q,E as Z,e as U,P as ee,ac as ae,ad as te,_ as le}from"./index-2J492Ujv.js";import{i as ne,d as se,b as oe,a as ie,u as re,c as ce}from"./index-v1K1KmsI.js";function ue(e,a,t){var l=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return ne(t)&&(l="leading"in t?!!t.leading:l,n="trailing"in t?!!t.trailing:n),se(e,a,{leading:l,maxWait:a,trailing:n})}const de=a({urlList:{type:t(Array),default:()=>l([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),fe={close:()=>!0,switch:e=>n(e),rotate:e=>n(e)},ve=["src"],me=v({name:"ElImageViewer"});const pe=u(i(v({...me,props:de,emits:fe,setup(e,{expose:a,emit:t}){const l=e,i={CONTAIN:{name:"contain",icon:m(p)},ORIGINAL:{name:"original",icon:m(g)}},{t:u}=oe(),d=s("image-viewer"),{nextZIndex:f}=ie(),v=y(),V=y([]),Q=b(),Z=y(!0),U=y(l.initialIndex),ee=w(i.CONTAIN),ae=y({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),te=k((()=>{const{urlList:e}=l;return e.length<=1})),le=k((()=>0===U.value)),ne=k((()=>U.value===l.urlList.length-1)),se=k((()=>l.urlList[U.value])),re=k((()=>[d.e("btn"),d.e("prev"),d.is("disabled",!l.infinite&&le.value)])),ce=k((()=>[d.e("btn"),d.e("next"),d.is("disabled",!l.infinite&&ne.value)])),de=k((()=>{const{scale:e,deg:a,offsetX:t,offsetY:l,enableTransition:n}=ae.value;let s=t/e,o=l/e;switch(a%360){case 90:case-270:[s,o]=[o,-s];break;case 180:case-180:[s,o]=[-s,-o];break;case 270:case-90:[s,o]=[-o,s]}const r={transform:`scale(${e}) rotate(${a}deg) translate(${s}px, ${o}px)`,transition:n?"transform .3s":""};return ee.value.name===i.CONTAIN.name&&(r.maxWidth=r.maxHeight="100%"),r})),fe=k((()=>n(l.zIndex)?l.zIndex:f()));function me(){Q.stop(),t("close")}function pe(){Z.value=!1}function ge(e){Z.value=!1,e.target.alt=u("el.image.error")}function ye(e){if(Z.value||0!==e.button||!v.value)return;ae.value.enableTransition=!1;const{offsetX:a,offsetY:t}=ae.value,l=e.pageX,n=e.pageY,s=ue((e=>{ae.value={...ae.value,offsetX:a+e.pageX-l,offsetY:t+e.pageY-n}})),o=c(document,"mousemove",s);c(document,"mouseup",(()=>{o()})),e.preventDefault()}function be(){ae.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function we(){if(Z.value)return;const e=(a=i,Object.keys(a));var a;const t=Object.values(i),l=ee.value.name,n=(t.findIndex((e=>e.name===l))+1)%e.length;ee.value=i[e[n]],be()}function ke(e){const a=l.urlList.length;U.value=(e+a)%a}function xe(){le.value&&!l.infinite||ke(U.value-1)}function he(){ne.value&&!l.infinite||ke(U.value+1)}function ze(e,a={}){if(Z.value)return;const{minScale:n,maxScale:s}=l,{zoomRate:o,rotateDeg:i,enableTransition:r}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":ae.value.scale>n&&(ae.value.scale=Number.parseFloat((ae.value.scale/o).toFixed(3)));break;case"zoomIn":ae.value.scale<s&&(ae.value.scale=Number.parseFloat((ae.value.scale*o).toFixed(3)));break;case"clockwise":ae.value.deg+=i,t("rotate",ae.value.deg);break;case"anticlockwise":ae.value.deg-=i,t("rotate",ae.value.deg)}ae.value.enableTransition=r}return x(se,(()=>{h((()=>{const e=V.value[0];(null==e?void 0:e.complete)||(Z.value=!0)}))})),x(U,(e=>{be(),t("switch",e)})),z((()=>{var e,a;!function(){const e=ue((e=>{switch(e.code){case r.esc:l.closeOnPressEscape&&me();break;case r.space:we();break;case r.left:xe();break;case r.up:ze("zoomIn");break;case r.right:he();break;case r.down:ze("zoomOut")}})),a=ue((e=>{ze((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})}));Q.run((()=>{c(document,"keydown",e),c(document,"wheel",a)}))}(),null==(a=null==(e=v.value)?void 0:e.focus)||a.call(e)})),a({setActiveItem:ke}),(e,a)=>(_(),C(K,{to:"body",disabled:!e.teleported},[I(J,{name:"viewer-fade",appear:""},{default:S((()=>[A("div",{ref_key:"wrapper",ref:v,tabindex:-1,class:N(O(d).e("wrapper")),style:E({zIndex:O(fe)})},[A("div",{class:N(O(d).e("mask")),onClick:a[0]||(a[0]=T((a=>e.hideOnClickModal&&me()),["self"]))},null,2),L(" CLOSE "),A("span",{class:N([O(d).e("btn"),O(d).e("close")]),onClick:me},[I(O(o),null,{default:S((()=>[I(O(R))])),_:1})],2),L(" ARROW "),O(te)?L("v-if",!0):(_(),j(B,{key:0},[A("span",{class:N(O(re)),onClick:xe},[I(O(o),null,{default:S((()=>[I(O(Y))])),_:1})],2),A("span",{class:N(O(ce)),onClick:he},[I(O(o),null,{default:S((()=>[I(O($))])),_:1})],2)],64)),L(" ACTIONS "),A("div",{class:N([O(d).e("btn"),O(d).e("actions")])},[A("div",{class:N(O(d).e("actions__inner"))},[I(O(o),{onClick:a[1]||(a[1]=e=>ze("zoomOut"))},{default:S((()=>[I(O(F))])),_:1}),I(O(o),{onClick:a[2]||(a[2]=e=>ze("zoomIn"))},{default:S((()=>[I(O(X))])),_:1}),A("i",{class:N(O(d).e("actions__divider"))},null,2),I(O(o),{onClick:we},{default:S((()=>[(_(),C(D(O(ee).icon)))])),_:1}),A("i",{class:N(O(d).e("actions__divider"))},null,2),I(O(o),{onClick:a[3]||(a[3]=e=>ze("anticlockwise"))},{default:S((()=>[I(O(M))])),_:1}),I(O(o),{onClick:a[4]||(a[4]=e=>ze("clockwise"))},{default:S((()=>[I(O(P))])),_:1})],2)],2),L(" CANVAS "),A("div",{class:N(O(d).e("canvas"))},[(_(!0),j(B,null,q(e.urlList,((e,a)=>W((_(),j("img",{ref_for:!0,ref:e=>V.value[a]=e,key:e,src:e,style:E(O(de)),class:N(O(d).e("img")),onLoad:pe,onError:ge,onMousedown:ye},null,46,ve)),[[H,a===U.value]]))),128))],2),G(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}}),[["__file","image-viewer.vue"]])),ge=a({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:t([String,Object])},previewSrcList:{type:t(Array),default:()=>l([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),ye={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>n(e),close:()=>!0,show:()=>!0},be=["src","loading"],we={key:0},ke=v({name:"ElImage",inheritAttrs:!1});const xe=u(i(v({...ke,props:ge,emits:ye,setup(a,{emit:t}){const l=a;let n="";const{t:o}=oe(),i=s("image"),r=V(),u=re(),v=y(),m=y(!1),p=y(!0),g=y(!1),b=y(),w=y(),I=e&&"loading"in HTMLImageElement.prototype;let T,R;const Y=k((()=>[i.e("inner"),X.value&&i.e("preview"),p.value&&i.is("loading")])),$=k((()=>r.style)),F=k((()=>{const{fit:a}=l;return e&&a?{objectFit:a}:{}})),X=k((()=>{const{previewSrcList:e}=l;return Array.isArray(e)&&e.length>0})),D=k((()=>{const{previewSrcList:e,initialIndex:a}=l;let t=a;return a>e.length-1&&(t=0),t})),M=k((()=>"eager"!==l.loading&&(!I&&"lazy"===l.loading||l.lazy))),P=()=>{e&&(p.value=!0,m.value=!1,v.value=l.src)};function H(e){p.value=!1,m.value=!1,t("load",e)}function W(e){p.value=!1,m.value=!0,t("error",e)}function q(){((a,t)=>{if(!e||!a||!t)return!1;const l=a.getBoundingClientRect();let n;return n=t instanceof Element?t.getBoundingClientRect():{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},l.top<n.bottom&&l.bottom>n.top&&l.right>n.left&&l.left<n.right})(b.value,w.value)&&(P(),ee())}const J=f(q,200,!0);async function K(){var a;if(!e)return;await h();const{scrollContainer:t}=l;d(t)?w.value=t:U(t)&&""!==t?w.value=null!=(a=document.querySelector(t))?a:void 0:b.value&&(w.value=ce(b.value)),w.value&&(T=c(w,"scroll",J),setTimeout((()=>q()),100))}function ee(){e&&w.value&&J&&(null==T||T(),w.value=void 0)}function ae(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function te(){X.value&&(R=c("wheel",ae,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",g.value=!0,t("show"))}function le(){null==R||R(),document.body.style.overflow=n,g.value=!1,t("close")}function ne(e){t("switch",e)}return x((()=>l.src),(()=>{M.value?(p.value=!0,m.value=!1,ee(),K()):P()})),z((()=>{M.value?K():P()})),(e,a)=>(_(),j("div",{ref_key:"container",ref:b,class:N([O(i).b(),e.$attrs.class]),style:E(O($))},[m.value?G(e.$slots,"error",{key:0},(()=>[A("div",{class:N(O(i).e("error"))},Q(O(o)("el.image.error")),3)])):(_(),j(B,{key:1},[void 0!==v.value?(_(),j("img",Z({key:0},O(u),{src:v.value,loading:e.loading,style:O(F),class:O(Y),onClick:te,onLoad:H,onError:W}),null,16,be)):L("v-if",!0),p.value?(_(),j("div",{key:1,class:N(O(i).e("wrapper"))},[G(e.$slots,"placeholder",{},(()=>[A("div",{class:N(O(i).e("placeholder"))},null,2)]))],2)):L("v-if",!0)],64)),O(X)?(_(),j(B,{key:2},[g.value?(_(),C(O(pe),{key:0,"z-index":e.zIndex,"initial-index":O(D),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:le,onSwitch:ne},{default:S((()=>[e.$slots.viewer?(_(),j("div",we,[G(e.$slots,"viewer")])):L("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):L("v-if",!0)],64)):L("v-if",!0)],6))}}),[["__file","image.vue"]])),he=(e=>(ae("data-v-c0c3d04f"),e=e(),te(),e))((()=>A("div",{class:"mask"},null,-1))),ze=le(v({__name:"index",props:{imgSrc:{type:String,default:""}},setup(e){const a=["fill","contain","cover","none","scale-down"],t=()=>{},l=()=>{};return(n,s)=>{const i=xe,r=ee("CaretRight"),c=o;return _(),j("div",{class:"playlist",onClick:l},[I(i,{class:"el_image",src:e.imgSrc,fit:a},null,8,["src"]),he,I(c,{class:"icon",size:40,color:"#fff",onClick:T(t,["stop"])},{default:S((()=>[I(r)])),_:1})])}}}),[["__scopeId","data-v-c0c3d04f"]]);export{ze as P,ue as t};
